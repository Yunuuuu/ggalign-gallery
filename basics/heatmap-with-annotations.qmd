---
categories: [ggheatmap()]
---

# Heatmap with Annotations

```{r}
library(ggalign)
```

```{r}
set.seed(123)
mat <- matrix(
    rnorm(100, mean = 0, sd = 2),
    nrow = 10, ncol = 10,
    dimnames = list(paste0("G", 1:10), paste0("S", 1:10))
)
```

Annotate top with color bars:

```{r}
ggheatmap(mat) +
    anno_top(size = unit(1, "cm")) +
    align_kmeans(centers = 3L) +
    ggalign(data = NULL) +
    geom_tile(aes(y = 1L, fill = .panel, color = .panel)) +
    theme_no_axes("y")
```

Annotate both left and right positions:

```{r}
#| classes: preview-image
ggheatmap(mat) +
    anno_right(size = 0.3) +
    align_dendro() +
    anno_left(size = 0.3) +
    ggalign(rowSums) +
    geom_bar(aes(x = value, y = .y, fill = value),
        orientation = "y", stat = "identity"
    ) +
    scale_fill_viridis_c(option = "A")
```
